<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>PulseCar</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet"
	href="https://fonts.googleapis.com/icon?family=Material+Icons" />
	 <script
      src="https://kit.fontawesome.com/9d7a2afbd4.js"
      crossorigin="anonymous"
    ></script>
<link rel="icon" type="image/x-icon" href="/images/favicon.ico" />
<link rel="stylesheet" href="css/w3.css" />
<link rel="stylesheet" href="css/cgoing.css" />
<link rel="stylesheet" href="css/jsk.css" />
<script src="js/w3.js"></script>
<script src="js/custom.js"></script>
<script src="js/cgoing.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
	<div id="wrapper">
		<!-- common í—¤ë” -->
		<div th:insert="common_header.html :: header"></div>

		<script>
        w3.includeHTML();
      </script>
		<!-- banner -->
		<div
			class="flex-container flex-center w3-large lnb-margin w3-padding w3-light-grey">
			<a th:href="@{car}">ì „ê¸°ì°¨ ê±°ë˜ í”Œë«í¼</a>
		</div>

		<!-- car detail -->

		<div id="car_detail">
			<div class="w3-panel w3-xlarge">
				<a th:href="@{car}">â† ë’¤ë¡œê°€ê¸° ğŸ¥°</a>
				<div class="w3-right">
					<a href="#" class="w3-margin-right">ğŸš— ì´ì „ ì°¨ëŸ‰</a> <a href="#">ë‹¤ìŒ
						ì°¨ëŸ‰ ğŸš•</a>
				</div>
			</div>
			<div class="w3-container">
				<input type="hidden" id="c_num" th:value="${cddto.c_num}" /> 
				<input type="hidden" id="dr_c_name" th:value="${cddto.dr_c_name}" />
				<h2 class="carName" th:utext="${cddto.c_name}">ì°¨ëŸ‰ ì´ë¦„</h2>
				<h2 class="carPrice w3-right" th:utext="${cddto.cp_price}+'ì›'">{ê°€ê²©}</h2>

				<div class="w3-large">
					<span class="kmAndDot" th:utext="${cddto.c_mile}">{ì£¼í–‰ê±°ë¦¬}</span> <span
						class="dot" th:utext="${cddto.c_year}+'ë…„ì‹'">{ì—°ì‹}</span> <span
						class="dot" th:utext="${cddto.c_scail}">{ì°¨ì¢…}</span> <span
						class="dot" th:utext="${cddto.c_coler}">{ìƒ‰ê¹”}</span> <span
						th:utext="${cddto.c_num}">{ì°¨ëŸ‰ë²ˆí˜¸}</span> <span
						style="display: inline-block; margin: 0 0 -15px 0;" id="heart"></span>
				</div>
			</div>
			<div class="flex-container-carDetail">
				<div class="pos-rel" id="carArea">
					<!-- í° ì´ë¯¸ì§€ Area -->
					<div id="gallery_photo">
						<img th:src="@{/image/__${carimg?.img_dir_1}__}" class="w3-image"
							id="focusImage" />
					</div>
					<!-- ì»¨íŠ¸ë¡¤ ë°” -->
					<div>
						<a class="prev" onclick="wanderImage(-1)">&#10094;</a> <a
							class="next" onclick="wanderImage(1)">&#10095;</a>
					</div>
					<!-- ì¸ë„¤ì¼ ì´ë¯¸ì§€ ë¦¬ìŠ¤íŠ¸ -->
					<div class="gallery_thumbnail gallery-flex">
						<img th:src="@{/image/__${carimg?.img_dir_1}__}"
							class="thumbnail activeThumb"
							onmouseover="changeFocusImage(this)" /> <img
							th:src="@{/image/__${carimg?.img_dir_2}__}" class="thumbnail"
							onmouseover="changeFocusImage(this)" /> <img
							th:src="@{/image/__${carimg?.img_dir_3}__}" class="thumbnail"
							onmouseover="changeFocusImage(this)" /> <img
							th:src="@{/image/__${carimg?.img_dir_4}__}" class="thumbnail"
							onmouseover="changeFocusImage(this)" /> <img
							th:src="@{/image/__${carimg?.img_dir_5}__}" class="thumbnail"
							onmouseover="changeFocusImage(this)" /> <img
							th:src="@{/image/__${carimg?.img_dir_6}__}" class="thumbnail"
							onmouseover="changeFocusImage(this)" />
					</div>
				</div>
				<!-- ë”œëŸ¬ ì„¤ëª… Area -->
				<div id="dealerArea"
					class="w3-center w3-border w3-border-black w3-round">
					<!-- <i class="material-icons"
						style="font-size: 150px; margin-top: 20px">face</i> -->
					<p style="font-size: 100px; margin-top: 20px; margin-bottom: -20px">[[${cddto.dr_icon}]]</p>
					<h3 th:utext="${cddto.dr_c_name}">{ìƒì‚¬ ì´ë¦„}</h3>
					<h4 class="dealer" th:utext="${cddto.dr_name}">{ë”œëŸ¬ ì´ë¦„}</h4>
					<div class="w3-large font-bold">
						<span class="partition-right" th:utext="|íŒë§¤ì¤‘ ${cddto.dr_selling}|">íŒë§¤ì¤‘ {}</span> 
						<span th:utext="|íŒë§¤ì™„ë£Œ ${cddto.dr_sold}|">íŒë§¤ì™„ë£Œ {}</span>
					</div>
					<p class="w3-large font-bold" th:utext="${cddto.dr_c_address}">{ì£¼ì†Œ}</p>
					<h3 class="w3-text-red" th:utext="${cddto.dr_c_phone}">ğŸ“
						{ì „í™”ë²ˆí˜¸}</h3>
					<h3 style="display: inline-block;" id="heart"></h3>
						<div style="float: right; margin-right: 73px;">
					<button class="cardetailbtn" onclick="pickClick()">ì°œí•˜ê¸°</button>
					<th:block th:if="${session.loginUser!= null}">
						<button class="cardetailbtn2" onclick="openCarReserForm()">ë°©ë¬¸ì˜ˆì•½</button>
					</th:block>
					<th:block th:unless="${session.loginUser!= null}">
						<button class="cardetailbtn2" onclick="car_detailNologin()">ë°©ë¬¸ì˜ˆì•½</button>
					</th:block>
					</div>
				</div>
			</div>

			<!-- ì•„í‹°í´ -->
			<div>
				<div class="j-border-tb">
					<table style="margin-left: 20px">
						<tr>
							<td><p class="w3-xlarge font-bold">íŒë§¤ì ì •ë³´
								<p></td>
						</tr>
						<tr>
							<td rowspan='2'><p
									style="font-size: 70px; margin-top: 30px; margin-bottom: 10px;">[[${cddto.dr_icon}]]</p></td>
							<td>
								<p>
								<h3>
									<span th:utext="${cddto.dr_c_name}">{ìƒì‚¬ ì´ë¦„}</span> <span
										class="dealer" th:utext="${cddto.dr_name}">{ë”œëŸ¬ ì´ë¦„}</span>
								</h3>
							</td>
						<tr>
							<td>
								<p>
									<span class="w3-large font-bold partition-right"
										th:utext="${cddto.dr_c_address}">{ì£¼ì†Œ}</span> <span
										class="w3-large" th:utext="${cddto.dr_c_phone}">ğŸ“
										{ì „í™”ë²ˆí˜¸}</span>
								</p>
							</td>
						</tr>
					</table>
				</div>
				<div style="margin-left: 20px">
					<p th:utext="${cddto.cp_content}"></p>
					<img src="images/cardetail_1.png" >
					<img src="images/cardetil_1.png" >
					<img src="images/cardetail_caution.png" >
				</div>
			</div>
		</div>

		<!-- common í‘¸í„° -->
		<div th:insert="common_footer.html::footer"></div>
		<script th:inline="javascript">	
		$.ajax({
			type: 'post',
			url: './carpickCheck',
			data: {
				id : [[${user.getId}]],
				p_num : [[${cddto.c_num}]]
			},
			success : function(result){
				if(result==1){
					$("#heart").html("<button class='heart-on w3-right' onclick='pickClick()'>ğŸ’—</button> ");
				}else{
					if([[${user.getId}]]==null){
						$("#heart").html("<button class='heart-off w3-right' onclick='clickEvent2Inline()'>ğŸ¤</button>");
					}else{
						$("#heart").html("<button class='heart-off w3-right' onclick='pickClick()'>ğŸ¤</button>");
					}
				}
			}
		});		
	</script>

		<script th:inline="javascript">	
	function pickClick(){
		$.ajax({
			type: 'post',
			url: './carpickCheck',
			data: {
				id : [[${user.getId}]],
				p_num : [[${cddto.c_num}]]
			},
			success : function(result){
				if(result==1){
					$("#heart").html("<button class='heart-off w3-right' onclick='pickClick()'>ğŸ¤</button>");
					carpickLiseDelete([[${user.getId}]],[[${cddto.c_num}]]);
				}else{
					if([[${user.getId}]]==null){
						//clickEvent2('pickshop',[[${cddto.c_num}]]);
						("#heart").html("<button class='heart-off w3-right' onclick='pickClick()'>ğŸ¤</button>");
					}
					$("#heart").html("<button class='heart-on w3-right' onclick='pickClick()'>ğŸ’—</button> ");
					carpickLiseInsert([[${user.getId}]],[[${cddto.c_num}]]);
				}
			}
		});		
	}
	function carpickLiseDelete(id, p_num) {
		$.ajax({
			type: 'post',
			url: './carpickListDelete',
			data: {
				id: id,
				p_num: p_num
			},
			success: function(result) {
				if (result) {
					console.log("ì°œ ì‚­ì œ ì™„ë£Œ")
				} else {
					console.log("ì‚­ì œ ì‹¤íŒ¨")
				}

			},
			error: function() {
				console.log("ì‚­ì œ ì—°ê²° ì—ëŸ¬")
			}
		});
	}
	function carpickLiseInsert(id, p_num) {
		$.ajax({
			type: 'post',
			url: './carpickListInsert',
			data: {
				id: id,
				p_num: p_num
			},
			success: function(result) {
				if (result) {
					console.log("ì°œ ì¶”ê°€ ì™„ë£Œ")
				} else {
					console.log("ì¶”ê°€ ì‹¤íŒ¨")
				}

			},
			error: function() {
				console.log("ì¶”ê°€ ì—°ê²° ì—ëŸ¬")
			}
		});
	}
	</script>
		<script th:inline="javascript">	
		function clickEvent2Inline(){
			up = confirm("ë¡œê·¸ì¸ í›„ ì´ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.\në¡œê·¸ì¸ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")
			if(up){
				var p_go = "pickshop";
				var item = [[${c_num}]];
				location.href = "loginForm?go=" + p_go + "&p_num=" + item;
			}else{
				return false;
			}
		}
		
	</script>
	<script th:inline="javascript">	
		function car_detailNologin(){
				up = confirm("ë¡œê·¸ì¸ í›„ ì´ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.\në¡œê·¸ì¸ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
				if(up){
					var car_num = [[${cddto.c_num}]];
					var id = [[${session.loginUser?.id}]];
					location.href = "loginForm?go=carDetail" + "&num="+car_num +"&id="+id;
				}else{
					return false;
				}
			}
	</script> 
	</div>
</body>
</html>
